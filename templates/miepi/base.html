<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{% block title %}Pase de Lista{% endblock %}</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
:root{
  --bg-main:linear-gradient(135deg,#c7d2fe,#fbcfe8);
  --bg-glass:rgba(255,255,255,.75);
  --bg-card:rgba(255,255,255,.82);
  --text-main:#334155;
  --text-muted:#64748b;
  --border-main:rgba(203,213,245,.8);
  --icon-color:#334155;
  --table-head:rgba(0,0,0,.04);
}
.dark{
  --bg-main:linear-gradient(135deg,#020617,#1e293b);
  --bg-glass:rgba(2,6,23,.75);
  --bg-card:rgba(2,6,23,.8);
  --text-main:#e5e7eb;
  --text-muted:#94a3b8;
  --border-main:rgba(51,65,85,.8);
  --icon-color:#ffffff;
  --table-head:rgba(255,255,255,.06);
}

/* Reset y básicos */
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:Inter,sans-serif;
  background:var(--bg-main);
  color:var(--text-main);
  min-height:100vh;
  overflow-x:hidden;
}
.wrapper{display:flex;min-height:100vh;}

/* Sidebar */
#sidebar{
  width:260px;
  background:var(--bg-glass);
  backdrop-filter:blur(16px);
  border-right:1px solid var(--border-main);
  display:flex;
  flex-direction:column;
  transition:left 0.3s ease;
}
.logo{
  height:64px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  font-size:22px;
  font-weight:700;
  border-bottom:1px solid var(--border-main);
}
.logo img{height:32px}

/* Sidebar nav */
nav{flex:1;padding:16px;}
nav p{
  font-size:11px;
  text-transform:uppercase;
  color:var(--text-muted);
  margin:16px 0 8px;
}
nav a{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px;
  color:var(--text-muted);
  text-decoration:none;
  border-radius:10px;
  transition: all 0.3s;
}
nav a:hover{
  background:rgba(0,0,0,.08);
  color:var(--text-main);
}

/* ===== BOTÓN MODO NOCTURNO (SIN FONDO) ===== */
.header-right button {
  background: transparent !important;
  border: none !important;
  padding: 6px;
  border-radius: 0;
  box-shadow: none;
}

.header-right button:hover,
.header-right button:focus,
.header-right button:active {
  background: transparent !important;
  box-shadow: none;
}

/* ===== LOGOUT IGUAL QUE LOS LINKS DEL SIDEBAR ===== */
.logout button{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px;
  width:100%;
  border-radius:10px;
  color:#dc2626;
  background:none;
  border:none;
  cursor:pointer;
  font-weight:600;
  text-align:left;
  transition: all 0.3s ease;
}

.logout button:hover{
  background:rgba(220,38,38,.1);
}
/* ===== LOGOUT IGUALADO EN TODAS LAS VISTAS ===== */
.logout {
  padding: 10px;
  border-top: 1px solid var(--border-main);
}

.logout button{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px;
  width:100%;
  border-radius:10px;
  color:#dc2626;
  background:none;
  border:none;
  cursor:pointer;
  font-weight:600;
  text-align:left;
  white-space: nowrap;        /* ← evita doble fila */
  transition: all 0.3s ease;
}

.logout button:hover{
  background:rgba(220,38,38,.1);
}


/* MAIN */
.main{flex:1;display:flex;flex-direction:column;overflow:hidden}

/* Header */
header{
  height:64px;
  background:var(--bg-glass);
  backdrop-filter:blur(16px);
  border-bottom:1px solid var(--border-main);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 20px;
  position:relative;
  z-index:1000;
}
.header-left{display:flex;align-items:center;gap:10px;}
.header-left img{height:32px;}
.header-title{
  flex:1;
  text-align:center;
  font-weight:600;
  font-size:18px;
  color:var(--text-main);
}
.header-right{
  display:flex;
  align-items:center;
  gap:8px;
}

/* Avatar */
.avatar{
  width:40px;height:40px;border-radius:50%;
  background:linear-gradient(135deg,#c7d2fe,#fbcfe8);
  display:flex;align-items:center;justify-content:center;font-weight:700;
}

main{
  flex:1;
  padding:24px;
  overflow-y:auto;
  overflow-x:auto; /* permite scroll horizontal si tabla es ancha */
}

/* Cards */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-bottom:24px;
}
.card{
  background:var(--bg-card);
  backdrop-filter:blur(16px);
  border:1px solid var(--border-main);
  border-radius:16px;
  padding:20px;
  transition: background 0.3s,color 0.3s,border-color 0.3s;
}
.card h4{
  font-size:12px;
  text-transform:uppercase;
  color:var(--text-muted);
}
.card p{
  font-size:28px;
  font-weight:700;
  margin-top:8px;
}

/* Badges */
.badge{
  padding:6px 14px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
}
.present{background:rgba(34,197,94,.2);color:#16a34a}
.late{background:rgba(234,179,8,.2);color:#ca8a04}
.absent{background:rgba(239,68,68,.2);color:#dc2626}

/* Footer */
footer{
  padding:12px;
  text-align:center;
  font-size:12px;
  border-top:1px solid var(--border-main);
  background:var(--bg-glass);
}


/* ===== NORMALIZAR BOTÓN LOGOUT EN TODAS LAS VISTAS ===== */
.logout {
  padding: 12px;
  border-top: 1px solid var(--border-main);
}

.logout form {
  margin: 0;
}

.logout button {
  display: flex;
  align-items: center;
  justify-content: flex-start;

  height: 44px;                 /* ← CLAVE: mismo alto siempre */
  width: 100%;

  padding: 0 14px;              /* padding horizontal fijo */
  gap: 10px;

  border-radius: 10px;
  background: transparent;
  border: none;

  color: #dc2626;
  font-weight: 600;
  white-space: nowrap;

  cursor: pointer;
  transition: background 0.25s ease;
}

.logout button:hover {
  background: rgba(223, 32, 32, 0.1);
}

/* FORM-CARD */
.form-card {
  background: rgba(255, 255, 255, 0.44);
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.1);
  backdrop-filter: blur(16px);
  transition: background 0.3s, color 0.3s;
}

/* INPUTS Y SELECTS */
input, select, textarea {
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  margin-top:4px;
  background: rgba(255,255,255,0.85);
  color: #334155;
  transition: all 0.3s;
}
label{color:#444; font-size:14px;}

/* MODO OSCURO */
.dark .card,
.dark .table-box,
.dark table th,
.dark table td,
.dark .form-card,
.dark input,
.dark select,
.dark textarea {
  background: var(--bg-card) !important;
  color: var(--text-main) !important;
  border-color: var(--border-main) !important;
}
.dark thead{
  background: var(--table-head) !important;
}
.dark label{
  color: var(--text-main) !important;
}

/* Sidebar y botón hamburguesa */
@media (max-width:1024px){
  #sidebar{
    position: fixed;
    top:0;
    left:-260px;
    height:100%;
    z-index:999;
  }
  #sidebar.show{left:0;}
  .sidebar-overlay{
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.4);
    z-index:998;
    display:none;
  }
  .sidebar-overlay.show{display:block;}
  .main{margin-left:0;}
  .sidebar-toggle{
    display:flex;
    align-items:center;
    justify-content:center;
    padding:8px;
    margin-right:10px;
    background: var(--bg-glass);
    border-radius:8px;
    cursor:pointer;
  }
}

@media (min-width:1025px){
  .sidebar-toggle{display:none !important;}
}

/* Tablas responsivas sin amontonar */
table{width:100%;border-collapse:collapse;}
table th, table td{padding:10px;vertical-align:middle;}
table td .action-btn{margin-right:8px;}

/* Para móviles: scroll horizontal */
@media(max-width:768px){
  table{display:block;overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch;}
  table td{display:inline-flex;gap:6px;flex-wrap:wrap;align-items:center;}
}
</style>

<script>
if(localStorage.getItem("theme")==="dark"){
  document.documentElement.classList.add("dark");
}
</script>

</head>
<body>
<div class="wrapper">

<aside id="sidebar">
<div class="logo">EBV</div>

<nav>
<p>Principal</p>
<a href="{% url 'miepi:dashboard' %}">
  <i class="fa-solid fa-gauge"></i>Registro
</a>

<p>Módulos</p>
<a href="{% url 'miepi:inscritos_list' %}">
  <i class="fa-solid fa-file-signature"></i>Lista de Inscritos
</a>

<a href="{% url 'miepi:escanear_asistencia' %}">
  <i class="fa-solid fa-qrcode"></i>Pase de lista
</a>

<a href="{% url 'miepi:lista_asistencias' %}">
  <i class="fa-solid fa-person-rays"></i>Asistencias
</a>
</nav>


<div class="logout">
<form method="post" action="{% url 'miepi:logout' %}">
{% csrf_token %}
<button type="submit"><i class="fa-solid fa-right-from-bracket"></i> Cerrar sesión</button>
</form>
</div>
</aside>

<div class="sidebar-overlay" onclick="toggleSidebar()"></div>

<div class="main">

<header>
<div class="header-left">
  <div class="sidebar-toggle" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>
  <img src="https://www.miepi.com/images/1miepi/LogoMIEPI.png" alt="Logo Izquierdo">
</div>
<div class="header-title">{% block header_title %}Pase de Lista{% endblock %}</div>
<div class="header-right">
  <img src="https://www.miepi.com/images/4ebv/logoEBV.png" alt="Logo Derecho" style="height:32px;">
  <button onclick="toggleTheme()">
    <i id="themeIcon" class="fa-solid fa-moon" style="color:var(--icon-color)"></i>
  </button>
</div>
</header>

<main>
{% block content %}{% endblock %}
</main>

<footer>© 2025 Sistema EBV</footer>

</div>
</div>

<script>
function toggleSidebar(){
  document.getElementById('sidebar').classList.toggle('show');
  document.querySelector('.sidebar-overlay').classList.toggle('show');
}

function toggleTheme(){
  const html=document.documentElement;
  html.classList.toggle("dark");
  const icon=document.getElementById("themeIcon");
  if(html.classList.contains("dark")){
    icon.className="fa-solid fa-sun";
    icon.style.color="var(--icon-color)";
  } else {
    icon.className="fa-solid fa-moon";
    icon.style.color="var(--icon-color)";
  }
  localStorage.setItem("theme", html.classList.contains("dark")?"dark":"light");
}
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
